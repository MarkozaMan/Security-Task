const AjaxHelper=function(r){return{authenticatedRequest:function(e){const i=r.Deferred();const t=function(){const e=KeycloakService.getTokenExpiresIn();if(e<300){return KeycloakService.refreshToken()}return r.when(KeycloakService.getToken())};if(KeycloakService.isAuthenticated()){t().then(function(t){const o=r.extend(true,{},e);const n=o.beforeSend;o.beforeSend=function(e){e.setRequestHeader("Authorization","Bearer "+t);if(n&&typeof n==="function"){n.call(this,e)}};r.ajax(o).done(function(e,t,n){i.resolve(e,t,n)}).fail(function(e,t,n){if(e.status===401){KeycloakService.refreshToken().then(function(){r.ajax(o).done(function(e,t,n){i.resolve(e,t,n)}).fail(function(e,t,n){i.reject(e,t,n)})}).fail(function(){i.reject(e,t,n);KeycloakService.login()})}else{i.reject(e,t,n)}})}).fail(function(){i.reject(null,"Token refresh failed","Session expired");KeycloakService.login()})}else{const n=r.extend(true,{},e);r.ajax(n).done(function(e,t,n){i.resolve(e,t,n)}).fail(function(e,t,n){i.reject(e,t,n)})}return i.promise()},get:function(e,t){return this.authenticatedRequest({url:e,method:"GET",data:t})},post:function(e,t,n="application/x-www-form-urlencoded"){return this.authenticatedRequest({url:e,method:"POST",data:t,contentType:n})},put:function(e,t){return this.authenticatedRequest({url:e,method:"PUT",contentType:"application/json",data:JSON.stringify(t)})},delete:function(e,t){return this.authenticatedRequest({url:e,method:"DELETE",data:JSON.stringify(t)})}}}(jQuery);